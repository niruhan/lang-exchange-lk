{"ast":null,"code":"import _regeneratorRuntime from \"/Users/niruhan/MSc/source_code/new/lang-exchange-lk/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/niruhan/MSc/source_code/new/lang-exchange-lk/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/niruhan/MSc/source_code/new/lang-exchange-lk/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/niruhan/MSc/source_code/new/lang-exchange-lk/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/niruhan/MSc/source_code/new/lang-exchange-lk/frontend/src/components/PostCard/PostCard.js\";\n\nfunction _templateObject13() {\n  var data = _taggedTemplateLiteral([\"\\n  margin-bottom: 5px;\\n  border-top: 1px solid \", \";\\n\"]);\n\n  _templateObject13 = function _templateObject13() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject12() {\n  var data = _taggedTemplateLiteral([\"\\n  padding: 0;\\n  padding-left: 4px;\\n  font-size: \", \";\\n\"]);\n\n  _templateObject12 = function _templateObject12() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject11() {\n  var data = _taggedTemplateLiteral([\"\\n  padding: 0 \", \";\\n\"]);\n\n  _templateObject11 = function _templateObject11() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject10() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  justify-content: center;\\n  border-top: 1px solid \", \";\\n\"]);\n\n  _templateObject10 = function _templateObject10() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject9() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding-bottom: \", \";\\n  font-size: \", \";\\n  color: \", \";\\n\"]);\n\n  _templateObject9 = function _templateObject9() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject8() {\n  var data = _taggedTemplateLiteral([\"\\n  padding: 0 \", \";\\n\"]);\n\n  _templateObject8 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  overflow: hidden;\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n  display: block;\\n  width: 100%;\\n  max-height: 700px;\\n  object-fit: cover;\\n  cursor: pointer;\\n  margin-bottom: \", \";\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  font-size: \", \";\\n  font-weight: \", \";\\n  color: \", \";\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  font-size: \", \";\\n  color: \", \";\\n  border-bottom: 1px solid \", \";\\n  border: 0;\\n  margin-top: 2px;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n  align-items: flex-start;\\n  padding: \", \" \", \";\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  border-radius: \", \";\\n  padding-bottom: \", \";\\n  background-color: \", \";\\n  border: 1px solid \", \";\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { generatePath } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { withApollo } from 'react-apollo';\nimport Comment from 'components/Comment';\nimport CreateComment from 'components/CreateComment';\nimport Like from 'components/Like';\nimport { DotsIcon, PostCommentIcon } from 'components/icons';\nimport { Spacing } from 'components/Layout';\nimport { A, H3 } from 'components/Text';\nimport { Button } from 'components/Form';\nimport PostCardOption from 'components/PostCard/PostCardOption';\nimport Modal from 'components/Modal';\nimport Avatar from 'components/Avatar';\nimport { GET_FOLLOWED_POSTS, DELETE_POST } from 'graphql/post';\nimport { GET_AUTH_USER } from 'graphql/user';\nimport { GET_USER_POSTS } from 'graphql/user';\nimport { HOME_PAGE_POSTS_LIMIT, PROFILE_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\nimport { useStore } from 'store';\nimport * as Routes from 'routes';\nimport { timeAgo } from 'utils/date';\nvar Root = styled.div(_templateObject(), function (p) {\n  return p.theme.radius.sm;\n}, function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.theme.colors.white;\n}, function (p) {\n  return p.theme.colors.border.main;\n});\nvar TopRow = styled.div(_templateObject2(), function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.theme.spacing.sm;\n});\nvar CreatedAt = styled.div(_templateObject3(), function (p) {\n  return p.theme.font.size.xxs;\n}, function (p) {\n  return p.theme.colors.text.hint;\n}, function (p) {\n  return p.theme.colors.text.secondary;\n});\nvar Author = styled(A)(_templateObject4());\nvar Name = styled.span(_templateObject5(), function (p) {\n  return p.theme.font.size.xs;\n}, function (p) {\n  return p.theme.font.weight.bold;\n}, function (p) {\n  return p.theme.colors.primary.main;\n});\nvar Poster = styled.img(_templateObject6(), function (p) {\n  return p.theme.spacing.sm;\n});\nvar BottomRow = styled.div(_templateObject7());\nvar CountAndIcons = styled.div(_templateObject8(), function (p) {\n  return p.theme.spacing.sm;\n});\nvar Count = styled.div(_templateObject9(), function (p) {\n  return p.theme.spacing.xs;\n}, function (p) {\n  return p.theme.font.size.xs;\n}, function (p) {\n  return p.theme.colors.text.secondary;\n});\nvar Icons = styled.div(_templateObject10(), function (p) {\n  return p.theme.colors.border.main;\n});\nvar Comments = styled.div(_templateObject11(), function (p) {\n  return p.theme.spacing.sm;\n});\nvar StyledButton = styled(Button)(_templateObject12(), function (p) {\n  return p.theme.font.size.xxs;\n});\nvar CommentLine = styled.div(_templateObject13(), function (p) {\n  return p.theme.colors.border.main;\n});\n/**\n * Component for rendering user post\n */\n\nvar PostCard = function PostCard(_ref) {\n  var author = _ref.author,\n      imagePublicId = _ref.imagePublicId,\n      comments = _ref.comments,\n      title = _ref.title,\n      createdAt = _ref.createdAt,\n      image = _ref.image,\n      likes = _ref.likes,\n      postId = _ref.postId,\n      openModal = _ref.openModal,\n      client = _ref.client;\n\n  var _useStore = useStore(),\n      _useStore2 = _slicedToArray(_useStore, 1),\n      auth = _useStore2[0].auth;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isCommentOpen = _useState2[0],\n      setIsCommentOpen = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isOptionOpen = _useState4[0],\n      setIsOptionOpen = _useState4[1];\n\n  var toggleCreateComment = function toggleCreateComment() {\n    setIsCommentOpen(true);\n  };\n\n  var toggleComment = function toggleComment() {\n    setIsCommentOpen(!isCommentOpen);\n  };\n\n  var closeOption = function closeOption() {\n    return setIsOptionOpen(false);\n  };\n\n  var openOption = function openOption() {\n    return setIsOptionOpen(true);\n  };\n\n  var deletePost =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return client.mutate({\n                mutation: DELETE_POST,\n                variables: {\n                  input: {\n                    id: postId,\n                    imagePublicId: imagePublicId\n                  }\n                },\n                refetchQueries: function refetchQueries() {\n                  return [{\n                    query: GET_FOLLOWED_POSTS,\n                    variables: {\n                      userId: auth.user.id,\n                      skip: 0,\n                      limit: HOME_PAGE_POSTS_LIMIT\n                    }\n                  }, {\n                    query: GET_AUTH_USER\n                  }, {\n                    query: GET_USER_POSTS,\n                    variables: {\n                      username: auth.user.username,\n                      skip: 0,\n                      limit: PROFILE_PAGE_POSTS_LIMIT\n                    }\n                  }];\n                }\n              });\n\n            case 3:\n              _context.next = 7;\n              break;\n\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 7:\n              setIsOptionOpen(false);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 5]]);\n    }));\n\n    return function deletePost() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(React.Fragment, null, React.createElement(Root, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, React.createElement(Modal, {\n    onClose: closeOption,\n    open: isOptionOpen,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, React.createElement(PostCardOption, {\n    postId: postId,\n    closeOption: closeOption,\n    author: author,\n    deletePost: deletePost,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  })), React.createElement(TopRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, React.createElement(Author, {\n    to: generatePath(Routes.USER_PROFILE, {\n      username: author.username\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, React.createElement(Avatar, {\n    image: author.image,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }), React.createElement(Spacing, {\n    left: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, React.createElement(Name, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, author.fullName), React.createElement(CreatedAt, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, timeAgo(createdAt)))), React.createElement(Button, {\n    ghost: true,\n    onClick: openOption,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, React.createElement(DotsIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }))), React.createElement(Spacing, {\n    left: \"sm\",\n    bottom: \"sm\",\n    top: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, React.createElement(H3, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, title)), image && React.createElement(Poster, {\n    src: image,\n    onClick: openModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }), React.createElement(BottomRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, React.createElement(CountAndIcons, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, React.createElement(Count, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, likes.length, \" likes\", React.createElement(Spacing, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }), React.createElement(StyledButton, {\n    onClick: toggleComment,\n    text: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, comments.length, \" comments\")), React.createElement(Icons, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, React.createElement(Like, {\n    fullWidth: true,\n    withText: true,\n    user: author,\n    postId: postId,\n    likes: likes,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }), React.createElement(Button, {\n    fullWidth: true,\n    text: true,\n    onClick: toggleCreateComment,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, React.createElement(PostCommentIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }), \" \", React.createElement(Spacing, {\n    inline: true,\n    left: \"xxs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }), \" \", React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }, \"Comment\")))), isCommentOpen && React.createElement(React.Fragment, null, React.createElement(Spacing, {\n    top: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244\n    },\n    __self: this\n  }, React.createElement(CommentLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245\n    },\n    __self: this\n  }), React.createElement(CreateComment, {\n    post: {\n      id: postId,\n      author: author\n    },\n    focus: isCommentOpen,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246\n    },\n    __self: this\n  })), comments.length > 0 && React.createElement(CommentLine, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  }), React.createElement(Comments, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254\n    },\n    __self: this\n  }, comments.map(function (comment) {\n    return React.createElement(Comment, {\n      key: comment.id,\n      comment: comment,\n      postId: postId,\n      postAuthor: author,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    });\n  }))))));\n};\n\nPostCard.propTypes = {\n  author: PropTypes.object.isRequired,\n  imagePublicId: PropTypes.string,\n  title: PropTypes.string.isRequired,\n  image: PropTypes.string,\n  likes: PropTypes.array.isRequired,\n  comments: PropTypes.array,\n  createdAt: PropTypes.string.isRequired,\n  postId: PropTypes.string.isRequired,\n  openModal: PropTypes.func.isRequired,\n  client: PropTypes.object.isRequired\n};\nexport default withApollo(PostCard);","map":{"version":3,"sources":["/Users/niruhan/MSc/source_code/new/lang-exchange-lk/frontend/src/components/PostCard/PostCard.js"],"names":["React","useState","PropTypes","generatePath","styled","withApollo","Comment","CreateComment","Like","DotsIcon","PostCommentIcon","Spacing","A","H3","Button","PostCardOption","Modal","Avatar","GET_FOLLOWED_POSTS","DELETE_POST","GET_AUTH_USER","GET_USER_POSTS","HOME_PAGE_POSTS_LIMIT","PROFILE_PAGE_POSTS_LIMIT","useStore","Routes","timeAgo","Root","div","p","theme","radius","sm","spacing","xs","colors","white","border","main","TopRow","CreatedAt","font","size","xxs","text","hint","secondary","Author","Name","span","weight","bold","primary","Poster","img","BottomRow","CountAndIcons","Count","Icons","Comments","StyledButton","CommentLine","PostCard","author","imagePublicId","comments","title","createdAt","image","likes","postId","openModal","client","auth","isCommentOpen","setIsCommentOpen","isOptionOpen","setIsOptionOpen","toggleCreateComment","toggleComment","closeOption","openOption","deletePost","mutate","mutation","variables","input","id","refetchQueries","query","userId","user","skip","limit","username","USER_PROFILE","fullName","length","map","comment","propTypes","object","isRequired","string","array","func"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { generatePath } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { withApollo } from 'react-apollo';\n\nimport Comment from 'components/Comment';\nimport CreateComment from 'components/CreateComment';\nimport Like from 'components/Like';\nimport { DotsIcon, PostCommentIcon } from 'components/icons';\nimport { Spacing } from 'components/Layout';\nimport { A, H3 } from 'components/Text';\nimport { Button } from 'components/Form';\nimport PostCardOption from 'components/PostCard/PostCardOption';\nimport Modal from 'components/Modal';\nimport Avatar from 'components/Avatar';\n\nimport { GET_FOLLOWED_POSTS, DELETE_POST } from 'graphql/post';\nimport { GET_AUTH_USER } from 'graphql/user';\nimport { GET_USER_POSTS } from 'graphql/user';\n\nimport {\n  HOME_PAGE_POSTS_LIMIT,\n  PROFILE_PAGE_POSTS_LIMIT,\n} from 'constants/DataLimit';\n\nimport { useStore } from 'store';\n\nimport * as Routes from 'routes';\n\nimport { timeAgo } from 'utils/date';\n\nconst Root = styled.div`\n  width: 100%;\n  border-radius: ${p => p.theme.radius.sm};\n  padding-bottom: ${p => p.theme.spacing.xs};\n  background-color: ${p => p.theme.colors.white};\n  border: 1px solid ${p => p.theme.colors.border.main};\n`;\n\nconst TopRow = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: flex-start;\n  padding: ${p => p.theme.spacing.xs} ${p => p.theme.spacing.sm};\n`;\n\nconst CreatedAt = styled.div`\n  font-size: ${p => p.theme.font.size.xxs};\n  color: ${p => p.theme.colors.text.hint};\n  border-bottom: 1px solid ${p => p.theme.colors.text.secondary};\n  border: 0;\n  margin-top: 2px;\n`;\n\nconst Author = styled(A)`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nconst Name = styled.span`\n  font-size: ${p => p.theme.font.size.xs};\n  font-weight: ${p => p.theme.font.weight.bold};\n  color: ${p => p.theme.colors.primary.main};\n`;\n\nconst Poster = styled.img`\n  display: block;\n  width: 100%;\n  max-height: 700px;\n  object-fit: cover;\n  cursor: pointer;\n  margin-bottom: ${p => p.theme.spacing.sm};\n`;\n\nconst BottomRow = styled.div`\n  overflow: hidden;\n`;\n\nconst CountAndIcons = styled.div`\n  padding: 0 ${p => p.theme.spacing.sm};\n`;\n\nconst Count = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  padding-bottom: ${p => p.theme.spacing.xs};\n  font-size: ${p => p.theme.font.size.xs};\n  color: ${p => p.theme.colors.text.secondary};\n`;\n\nconst Icons = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  border-top: 1px solid ${p => p.theme.colors.border.main};\n`;\n\nconst Comments = styled.div`\n  padding: 0 ${p => p.theme.spacing.sm};\n`;\n\nconst StyledButton = styled(Button)`\n  padding: 0;\n  padding-left: 4px;\n  font-size: ${p => p.theme.font.size.xxs};\n`;\n\nconst CommentLine = styled.div`\n  margin-bottom: 5px;\n  border-top: 1px solid ${p => p.theme.colors.border.main};\n`;\n\n/**\n * Component for rendering user post\n */\nconst PostCard = ({\n  author,\n  imagePublicId,\n  comments,\n  title,\n  createdAt,\n  image,\n  likes,\n  postId,\n  openModal,\n  client,\n}) => {\n  const [{ auth }] = useStore();\n  const [isCommentOpen, setIsCommentOpen] = useState(false);\n  const [isOptionOpen, setIsOptionOpen] = useState(false);\n\n  const toggleCreateComment = () => {\n    setIsCommentOpen(true);\n  };\n\n  const toggleComment = () => {\n    setIsCommentOpen(!isCommentOpen);\n  };\n\n  const closeOption = () => setIsOptionOpen(false);\n\n  const openOption = () => setIsOptionOpen(true);\n\n  const deletePost = async () => {\n    try {\n      await client.mutate({\n        mutation: DELETE_POST,\n        variables: { input: { id: postId, imagePublicId } },\n        refetchQueries: () => [\n          {\n            query: GET_FOLLOWED_POSTS,\n            variables: {\n              userId: auth.user.id,\n              skip: 0,\n              limit: HOME_PAGE_POSTS_LIMIT,\n            },\n          },\n          { query: GET_AUTH_USER },\n          {\n            query: GET_USER_POSTS,\n            variables: {\n              username: auth.user.username,\n              skip: 0,\n              limit: PROFILE_PAGE_POSTS_LIMIT,\n            },\n          },\n        ],\n      });\n    } catch (err) {}\n\n    setIsOptionOpen(false);\n  };\n\n  return (\n    <>\n      <Root>\n        <Modal onClose={closeOption} open={isOptionOpen}>\n          <PostCardOption\n            postId={postId}\n            closeOption={closeOption}\n            author={author}\n            deletePost={deletePost}\n          />\n        </Modal>\n\n        <TopRow>\n          <Author\n            to={generatePath(Routes.USER_PROFILE, {\n              username: author.username,\n            })}\n          >\n            <Avatar image={author.image} />\n\n            <Spacing left=\"xs\">\n              <Name>{author.fullName}</Name>\n              <CreatedAt>{timeAgo(createdAt)}</CreatedAt>\n            </Spacing>\n          </Author>\n\n          <Button ghost onClick={openOption}>\n            <DotsIcon />\n          </Button>\n        </TopRow>\n\n        <Spacing left=\"sm\" bottom=\"sm\" top=\"xs\">\n          <H3>{title}</H3>\n        </Spacing>\n\n        {image && <Poster src={image} onClick={openModal} />}\n\n        <BottomRow>\n          <CountAndIcons>\n            <Count>\n              {likes.length} likes\n              <Spacing />\n              <StyledButton onClick={toggleComment} text>\n                {comments.length} comments\n              </StyledButton>\n            </Count>\n\n            <Icons>\n              <Like\n                fullWidth\n                withText\n                user={author}\n                postId={postId}\n                likes={likes}\n              />\n\n              <Button fullWidth text onClick={toggleCreateComment}>\n                <PostCommentIcon /> <Spacing inline left=\"xxs\" /> <b>Comment</b>\n              </Button>\n            </Icons>\n          </CountAndIcons>\n\n          {isCommentOpen && (\n            <>\n              <Spacing top=\"xs\">\n                <CommentLine />\n                <CreateComment\n                  post={{ id: postId, author }}\n                  focus={isCommentOpen}\n                />\n              </Spacing>\n\n              {comments.length > 0 && <CommentLine />}\n\n              <Comments>\n                {comments.map(comment => (\n                  <Comment\n                    key={comment.id}\n                    comment={comment}\n                    postId={postId}\n                    postAuthor={author}\n                  />\n                ))}\n              </Comments>\n            </>\n          )}\n        </BottomRow>\n      </Root>\n    </>\n  );\n};\n\nPostCard.propTypes = {\n  author: PropTypes.object.isRequired,\n  imagePublicId: PropTypes.string,\n  title: PropTypes.string.isRequired,\n  image: PropTypes.string,\n  likes: PropTypes.array.isRequired,\n  comments: PropTypes.array,\n  createdAt: PropTypes.string.isRequired,\n  postId: PropTypes.string.isRequired,\n  openModal: PropTypes.func.isRequired,\n  client: PropTypes.object.isRequired,\n};\n\nexport default withApollo(PostCard);\n"]},"metadata":{},"sourceType":"module"}